#This code contains the key functions for the first stage
